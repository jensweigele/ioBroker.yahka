{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../lib/utils.js","webpack:///../node_modules/webpack/buildin/module.js","webpack:///./main.ts","webpack:///./shared/yahka.logger.ts","webpack:///./yahka.community.types.ts","webpack:///./yahka.functions/conversion.base.ts","webpack:///./yahka.functions/conversion.homekit.homematic.ts","webpack:///./yahka.functions/conversion.inverse.ts","webpack:///./yahka.functions/conversion.map.ts","webpack:///./yahka.functions/conversion.passthrough.ts","webpack:///./yahka.functions/conversion.scale.ts","webpack:///./yahka.functions/conversion.script.ts","webpack:///./yahka.functions/functions.base.ts","webpack:///./yahka.functions/functions.factory.ts","webpack:///./yahka.functions/functions.import.ts","webpack:///./yahka.functions/iofunc.base.ts","webpack:///./yahka.functions/iofunc.const.ts","webpack:///./yahka.functions/iofunc.homematic.covering.ts","webpack:///./yahka.functions/iofunc.multi-state.ts","webpack:///./yahka.functions/iofunc.state.ts","webpack:///./yahka.homekit-bridge.ts","webpack:///./yahka.homekit-ipcamera.ts","webpack:///./yahka.ioBroker-adapter.ts","webpack:///external \"child_process\"","webpack:///external \"debug\"","webpack:///external \"dev-null\"","webpack:///external \"hap-nodejs\"","webpack:///external \"hap-nodejs-community-types\"","webpack:///external \"hap-nodejs/lib/Characteristic\"","webpack:///external \"hap-nodejs/lib/Service\"","webpack:///external \"hap-nodejs/lib/StreamController\"","webpack:///external \"hap-nodejs/lib/gen/HomeKitTypes\"","webpack:///external \"ip\"","webpack:///external \"util\""],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,YAAY;AACrB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACrBA;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2BG;AAEH,kBAAkB,uBAAsB;AACxC,sBAAsB;AACT;;AACb,sDAAgC;AAChC,KAAK,CA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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./main.ts\");\n","'use strict';\r\n\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nlet controllerDir;\r\nlet appName;\r\n\r\n/**\r\n * returns application name\r\n *\r\n * The name of the application can be different and this function finds it out.\r\n *\r\n * @returns {string}\r\n */\r\n function getAppName() {\r\n    const parts = __dirname.replace(/\\\\/g, '/').split('/');\r\n    return parts[parts.length - 2].split('.')[0];\r\n}\r\n\r\n/**\r\n * looks for js-controller home folder\r\n *\r\n * @param {boolean} isInstall\r\n * @returns {string}\r\n */\r\nfunction getControllerDir(isInstall) {\r\n    // Find the js-controller location\r\n    const possibilities = [\r\n        'iobroker.js-controller',\r\n        'ioBroker.js-controller',\r\n    ];\r\n    /** @type {string} */\r\n    let controllerPath;\r\n    for (const pkg of possibilities) {\r\n        try {\r\n            const possiblePath = require.resolve(pkg);\r\n            if (fs.existsSync(possiblePath)) {\r\n                controllerPath = possiblePath;\r\n                break;\r\n            }\r\n        } catch (e) { /* not found */ }\r\n    }\r\n    if (controllerPath == null) {\r\n        if (!isInstall) {\r\n            console.log('Cannot find js-controller');\r\n            process.exit(10);\r\n        } else {\r\n            process.exit();\r\n        }\r\n    }\r\n    // we found the controller\r\n    return path.dirname(controllerPath);\r\n}\r\n\r\n/**\r\n * reads controller base settings\r\n *\r\n * @alias getConfig\r\n * @returns {object}\r\n */\r\n function getConfig() {\r\n    let configPath;\r\n    if (fs.existsSync(\r\n        configPath = path.join(controllerDir, 'conf', appName + '.json')\r\n    )) {\r\n        return JSON.parse(fs.readFileSync(configPath, 'utf8'));\r\n    } else if (fs.existsSync(\r\n        configPath = path.join(controllerDir, 'conf', + appName.toLowerCase() + '.json')\r\n    )) {\r\n        return JSON.parse(fs.readFileSync(configPath, 'utf8'));\r\n    } else {\r\n        throw new Error('Cannot find ' + controllerDir + '/conf/' + appName + '.json');\r\n    }\r\n}\r\nappName       = getAppName();\r\ncontrollerDir = getControllerDir(typeof process !== 'undefined' && process.argv && process.argv.indexOf('--install') !== -1);\r\nconst adapter = require(path.join(controllerDir, 'lib/adapter.js'));\r\n\r\nexports.controllerDir = controllerDir;\r\nexports.getConfig =     getConfig;\r\nexports.Adapter =       adapter;\r\nexports.appName =       appName;\r\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","/**\n *\n * iobroker.yahka adapter\n *\n *\n *  file io-package.json comments:\n *\n *  {\n *      \"common\": {\n *          \"name\":         \"iobroker.yahka\",                  // name has to be set and has to be equal to adapters folder name and main file name excluding extension\n *          \"version\":      \"0.0.0\",                    // use \"Semantic Versioning\"! see http://semver.org/\n *          \"title\":        \"Node.js iobroker.yahka Adapter\",  // Adapter title shown in User Interfaces\n *          \"authors\":  [                               // Array of authord\n *              \"name <mail@iobroker.yahka.com>\"\n *          ]\n *          \"desc\":         \"iobroker.yahka adapter\",          // Adapter description shown in User Interfaces. Can be a language object {de:\"...\",ru:\"...\"} or a string\n *          \"platform\":     \"Javascript/Node.js\",       // possible values \"javascript\", \"javascript/Node.js\" - more coming\n *          \"mode\":         \"daemon\",                   // possible values \"daemon\", \"schedule\", \"subscribe\"\n *          \"schedule\":     \"0 0 * * *\"                 // cron-style schedule. Only needed if mode=schedule\n *          \"loglevel\":     \"info\"                      // Adapters Log Level\n *      },\n *      \"native\": {                                     // the native object is available via adapter.config in your adapters code - use it for configuration\n *          \"test1\": true,\n *          \"test2\": 42\n *      }\n *  }\n *\n */\n\n/* jshint -W097 */// jshint strict:false\n/*jslint node: true */\n\"use strict\";\nimport debug = require('debug');\ndebug.enable('EventedHTTPServer,HAPServer,Accessory,AccessoryLoader');\n\n// you have to require the utils module and call adapter function\nimport utils = require(\"../lib/utils\"); // Get common adapter utils\nimport * as hkAdapter from './yahka.ioBroker-adapter';\nrequire(\"./yahka.functions/functions.import\");\n\nlet yahkaAdapter: hkAdapter.TIOBrokerAdapter;\nfunction startAdapter(options: any = {}) {\n\tconst ioAdapter = utils.Adapter({name: 'yahka', systemConfig: true});\n    yahkaAdapter = new hkAdapter.TIOBrokerAdapter(ioAdapter, utils.controllerDir);\n    return ioAdapter;\n}\n\n// ...\n\nif (module && module.parent) {\n\t// Export startAdapter in compact mode\n\tmodule.exports = startAdapter;\n} else {\n\t// Otherwise start the adapter immediately\n\tstartAdapter();\n}\n\n\n\n","import { ILogger } from \"../yahka.homekit-bridge\";\n\nexport class YahkaLogger implements ILogger {\n    constructor(protected adapter: ioBroker.IAdapter, private logIdentifier: string) {\n\n    }\n\n    public debug(message: string) {\n        return this.adapter.log.debug(\"[\" + this.logIdentifier + \"] \" + message);\n    }\n    public info(message: string) {\n        return this.adapter.log.info(\"[\" + this.logIdentifier + \"] \" + message);\n    }\n    public warn(message: string) {\n        return this.adapter.log.warn(\"[\" + this.logIdentifier + \"] \" + message);\n    }\n    public error(message: string) {\n        return this.adapter.log.error(\"[\" + this.logIdentifier + \"] \" + message);\n    }\n}\n","import { Characteristic } from 'hap-nodejs/lib/Characteristic';\nimport { Service } from 'hap-nodejs/lib/Service';\nimport 'hap-nodejs/lib/gen/HomeKitTypes';\nimport * as HapCommunity from 'hap-nodejs-community-types';\nimport { inherits } from 'util';\n\nlet hapTypesImported = false;\nexport function importHAPCommunityTypesAndFixes() {\n\n    if (hapTypesImported)\n        return;\n\n    let curTempCharacteristicFunction = <Function>Characteristic.CurrentTemperature;\n    let curTempCharacteristicType = Characteristic.CurrentTemperature;\n\n    if (curTempCharacteristicFunction !== undefined) {\n        Characteristic.CurrentTemperature = function () {\n            curTempCharacteristicFunction.call(this);\n            this.setProps({ minValue: -99 });\n        }\n        inherits(Characteristic.CurrentTemperature, curTempCharacteristicFunction);\n        Characteristic.CurrentTemperature.UUID = curTempCharacteristicType.UUID;\n    }\n\n    let fakeBridge = {\n        hap: {\n            Service: Service,\n            Characteristic: Characteristic\n        }\n    }\n    let fakeOptions = {};\n    let communityTypes = HapCommunity(fakeBridge, fakeOptions);\n\n    for (let type in communityTypes) {\n        let typeFct: Function = communityTypes[type];\n        if (typeFct.length == 0) {  // characteristic\n            Characteristic[\"Community: \" + type] = typeFct;\n        } else if (typeFct.length == 2) { // service\n            Service[\"Community: \" + type] = typeFct;\n        }\n    }\n    hapTypesImported = true;\n}\n","import { TYahkaFunctionBase } from './functions.base';\nexport { IConversionFunction } from '../yahka.homekit-bridge';\nexport abstract class TIOBrokerConversionBase extends TYahkaFunctionBase {\n    constructor(adapter: ioBroker.IAdapter, logIdentifier: string = \"\") {\n        super(adapter, logIdentifier);\n    }\n\n    protected static castToNumber(value: any): number {\n        if (value === undefined)\n            return undefined;\n        if (typeof value !== 'number')\n            return Number(value);\n        else\n            return value;\n    }\n\n    protected static parameterValueByName(parameters: any, name: string): any {\n        let paramArray = undefined;\n        if (typeof parameters === 'object') {\n            paramArray = parameters\n        } else {\n            paramArray = JSON.parse(parameters);\n        }\n        if (paramArray === undefined)\n            return undefined;\n        return paramArray[name];\n    }\n}\n\n","import { TIOBrokerConversionBase, IConversionFunction } from \"./conversion.base\";\nimport { HAPCharacteristic } from \"../yahka.homekit-bridge\";\n\n\nexport class TIoBrokerConversion_HomematicDirection_To_PositionState extends TIOBrokerConversionBase implements IConversionFunction {\n    toHomeKit(value: any) {\n        let num = TIOBrokerConversionBase.castToNumber(value)\n        let result = undefined;\n        switch (num) {\n            case 0:\n                result = HAPCharacteristic.PositionState.STOPPED;\n                break;\n            case 1:\n                result = HAPCharacteristic.PositionState.INCREASING;\n                break;\n            case 2:\n                result = HAPCharacteristic.PositionState.DECREASING;\n                break;\n            default:\n                result = HAPCharacteristic.PositionState.STOPPED;\n                break;\n        }\n        this.adapter.log.debug('HomematicDirectionToHomekitPositionState.toHomeKit, from ' + JSON.stringify(value) + '[' + (typeof value) + '] to ' + JSON.stringify(result));\n        return result;\n    }\n    toIOBroker(value: any) {\n        let num = TIOBrokerConversionBase.castToNumber(value)\n        let result = undefined;\n        switch (num) {\n            case HAPCharacteristic.PositionState.STOPPED:\n                result = 0;\n                break;\n            case HAPCharacteristic.PositionState.INCREASING:\n                result = 1;\n                break;\n            case HAPCharacteristic.PositionState.DECREASING:\n                result = 2;\n                break;\n            default:\n                result = 0;\n                break;\n        }\n        this.adapter.log.debug('HomematicDirectionToHomekitPositionState.toIOBroker, from ' + JSON.stringify(value) + '[' + (typeof value) + '] to ' + JSON.stringify(result));\n        return result;\n    }\n}\n\n\nexport class TIoBrokerConversion_HomematicControlMode_To_CoolingState extends TIOBrokerConversionBase implements IConversionFunction {\n    toHomeKit(value: any) {\n        let num = TIOBrokerConversionBase.castToNumber(value)\n\n        let result = undefined;\n        switch (num) {\n            case 0:\n                result = HAPCharacteristic.TargetHeatingCoolingState.AUTO;\n                break;\n            case 1:\n                result = HAPCharacteristic.TargetHeatingCoolingState.HEAT;\n                break;\n            case 2:\n                result = HAPCharacteristic.TargetHeatingCoolingState.HEAT;\n                break;\n            case 3:\n                result = HAPCharacteristic.TargetHeatingCoolingState.HEAT;\n                break;\n            default:\n                result = HAPCharacteristic.TargetHeatingCoolingState.OFF;\n                break;\n        }\n        this.adapter.log.debug('HomematicDirectionToHomekitHeatingCoolingState.toHomeKit, from ' + JSON.stringify(value) + '[' + (typeof value) + '] to ' + JSON.stringify(result));\n        return result;\n    }\n    toIOBroker(value) {\n        let num = TIOBrokerConversionBase.castToNumber(value)\n\n        let result = undefined;\n        switch (num) {\n            case HAPCharacteristic.TargetHeatingCoolingState.OFF:\n                result = 0;\n                break;\n            case HAPCharacteristic.TargetHeatingCoolingState.HEAT:\n                result = 1;\n                break;\n            case HAPCharacteristic.TargetHeatingCoolingState.COOL:\n                result = 0;\n                break;\n            case HAPCharacteristic.TargetHeatingCoolingState.AUTO:\n                result = 0;\n                break;\n            default:\n                result = 0;\n                break;\n        }\n        this.adapter.log.debug('HomematicDirectionToHomekitHeatingCoolingState.toIOBroker, from ' + JSON.stringify(value) + '[' + (typeof value) + '] to ' + JSON.stringify(result));\n        return result;\n    }\n}\n","import { TIOBrokerConversionBase, IConversionFunction } from \"./conversion.base\";\n\n\nexport class TIoBrokerConversion_Inverse extends TIOBrokerConversionBase implements IConversionFunction {\n\n\n    static create(adapter: ioBroker.IAdapter, parameters: any): IConversionFunction {\n        let maxValue = this.castToNumber(parameters);\n        return new TIoBrokerConversion_Inverse(adapter, maxValue);\n    }\n    constructor(adapter: ioBroker.IAdapter, protected maxValue: number) {\n        super(adapter);\n    }\n\n    toHomeKit(value: any) {\n        let num: number = TIOBrokerConversionBase.castToNumber(value)\n        let newValue = this.maxValue - num;\n        this.adapter.log.debug('inverse: converting value to homekit: ' + value + ' to ' + newValue);\n        return newValue;\n    }\n    toIOBroker(value: any) {\n        let num: number = TIOBrokerConversionBase.castToNumber(value)\n        let newValue = this.maxValue - num;\n        this.adapter.log.debug('inverse: converting value to ioBroker: ' + value + ' to ' + newValue);\n        return newValue;\n    }\n}","import { TIOBrokerConversionBase, IConversionFunction } from \"./conversion.base\";\n\nexport interface IIoBrokerConversion_MapEntry {\n    left: any;\n    right: any;\n}\nexport interface IIoBrokerConversion_Map_Parameters {\n    mappings: IIoBrokerConversion_MapEntry[];\n}\nexport function isMultiStateParameter(params: any): params is IIoBrokerConversion_Map_Parameters {\n    return \"mappings\" in params;\n}\n\nexport class TIoBrokerConversion_Map extends TIOBrokerConversionBase implements IConversionFunction {\n    protected mappingArrayToHomeKit = new Map<string, any>();\n    protected mappingArrayToIOBroker = new Map<string, any>();\n    private jsonReplacer = (key, value) => String(value);\n\n    static create(adapter: ioBroker.IAdapter, parameters: any): IConversionFunction {\n        if (!isMultiStateParameter(parameters)) {\n            return undefined;\n        }\n\n        return new TIoBrokerConversion_Map(adapter, parameters);\n    }\n\n    constructor(adapter: ioBroker.IAdapter, protected parameters: IIoBrokerConversion_Map_Parameters) {\n        super(adapter, \"TIoBrokerConversion_Map\");\n        this.buildMappingArray();\n    }\n\n    buildMappingArray() {\n        for(let mapDef of this.parameters.mappings) {\n            let leftStr = JSON.stringify(mapDef.left, this.jsonReplacer);\n            let rightStr = JSON.stringify(mapDef.right, this.jsonReplacer);\n            \n            this.mappingArrayToHomeKit.set(leftStr, mapDef.right);\n            this.mappingArrayToIOBroker.set(rightStr, mapDef.left);\n        }\n    }\n\n    toHomeKit(value: any) {\n        let ioValueStr = JSON.stringify(value, this.jsonReplacer);\n        return this.mappingArrayToHomeKit.get(ioValueStr);\n    }\n    toIOBroker(value: any) {\n        let hkValueStr = JSON.stringify(value, this.jsonReplacer);\n        return this.mappingArrayToIOBroker.get(hkValueStr);\n    }\n}","import { IConversionFunction } from \"../yahka.homekit-bridge\";\nimport { TIOBrokerConversionBase } from \"./conversion.base\";\n\nexport class TIoBrokerConversion_Passthrough extends TIOBrokerConversionBase implements IConversionFunction {\n    toHomeKit(value: any) {\n        return value\n    }\n    toIOBroker(value: any) {\n        return value\n    }\n}","import { TIOBrokerConversionBase, IConversionFunction } from \"./conversion.base\";\n\nexport interface IIoBrokerConversionScaleParameters {\n    \"homekit.min\": number;\n    \"homekit.max\": number;\n    \"iobroker.min\": number;\n    \"iobroker.max\": number;\n}\n\nexport class TIoBrokerConversion_Scale extends TIOBrokerConversionBase implements IConversionFunction {\n    static isScaleParameter(parameters: any): parameters is IIoBrokerConversionScaleParameters {\n        const castedParam = <IIoBrokerConversionScaleParameters>parameters;\n        return castedParam[\"homekit.min\"] !== undefined &&\n            castedParam[\"homekit.max\"] !== undefined &&\n            castedParam[\"iobroker.min\"] !== undefined &&\n            castedParam[\"iobroker.max\"] !== undefined;\n    }\n    static create(adapter: ioBroker.IAdapter, parameters: any): IConversionFunction {\n        let params: IIoBrokerConversionScaleParameters;\n        if (TIoBrokerConversion_Scale.isScaleParameter(parameters)) {\n            params = parameters;\n        } else {\n            params = {\n                \"homekit.min\": 0,\n                \"homekit.max\": 1,\n                \"iobroker.min\": 0,\n                \"iobroker.max\": 1\n            }\n        }\n        return new TIoBrokerConversion_Scale(adapter, params);\n    }\n    constructor(adapter: ioBroker.IAdapter, protected parameters: IIoBrokerConversionScaleParameters) {\n        super(adapter);\n    }\n\n    toHomeKit(value) {\n        let num: number = TIOBrokerConversionBase.castToNumber(value);\n        let homeKitMax = this.parameters[\"homekit.max\"];\n        let ioBrokerMax = this.parameters[\"iobroker.max\"];\n        let homeKitMin = this.parameters[\"homekit.min\"];\n        let ioBrokerMin = this.parameters[\"iobroker.min\"];\n        let newValue = ((num - ioBrokerMin) / (ioBrokerMax - ioBrokerMin)) * (homeKitMax - homeKitMin);\n        this.adapter.log.debug('scaleInt: converting value to homekit: ' + value + ' to ' + newValue);\n        return newValue;\n    }\n    toIOBroker(value) {\n        let num: number = TIOBrokerConversionBase.castToNumber(value);\n        let homeKitMax = this.parameters[\"homekit.max\"];\n        let ioBrokerMax = this.parameters[\"iobroker.max\"];\n        let homeKitMin = this.parameters[\"homekit.min\"];\n        let ioBrokerMin = this.parameters[\"iobroker.min\"];\n        let newValue = ((num - homeKitMin) / (homeKitMax - homeKitMin)) * (ioBrokerMax - ioBrokerMin);\n        this.adapter.log.debug('scaleInt: converting value to ioBroker: ' + value + ' to ' + newValue);\n        return newValue;\n    }\n}","import { TIOBrokerConversionBase, IConversionFunction } from \"./conversion.base\";\n\n\nexport interface IIoBrokerConversionScriptParameters {\n    toHomeKit: string;\n    toIOBroker: string;\n}\n\nexport class TIoBrokerConversion_Script extends TIOBrokerConversionBase implements IConversionFunction {\n    static isScriptParameter(parameters: any): parameters is IIoBrokerConversionScriptParameters {\n        const castedParam = <IIoBrokerConversionScriptParameters>parameters;\n        return castedParam[\"toHomeKit\"] !== undefined &&\n            castedParam[\"toIOBroker\"] !== undefined;\n    }\n\n    static create(adapter: ioBroker.IAdapter, parameters: any): IConversionFunction {\n        let params: IIoBrokerConversionScriptParameters;\n        if (TIoBrokerConversion_Script.isScriptParameter(parameters)) {\n            params = parameters;\n        } else {\n            params = {\n                toHomeKit: \"return value\",\n                toIOBroker: \"return value\"\n            }\n        }\n        return new TIoBrokerConversion_Script(adapter, params);\n    }\n\n    private toHKFunction: Function;\n    private toIOFunction: Function;\n\n    constructor(adapter: ioBroker.IAdapter, protected parameters: IIoBrokerConversionScriptParameters) {\n        super(adapter);\n        this.toHKFunction = new Function(\"value\", this.parameters.toHomeKit);\n        this.toIOFunction = new Function(\"value\", this.parameters.toIOBroker);\n    }\n    \n    toHomeKit(value: any) { \n        let newValue = this.toHKFunction(value);\n        this.adapter.log.debug('script: converting value to homekit: ' + value + ' to ' + newValue); \n        return newValue; \n    }\n    toIOBroker(value: any) { \n        let newValue = this.toIOFunction(value);\n        this.adapter.log.debug('script: converting value to ioBroker: ' + value + ' to ' + newValue); \n        return newValue; \n    }\n}","import { IInOutFunction, IInOutChangeNotify, ILogger } from \"../yahka.homekit-bridge\";\nimport { ISubscriptionRequestor, ISubscriptionRequest } from \"../yahka.ioBroker-adapter\";\nimport { YahkaLogger } from \"../shared/yahka.logger\";\n\nexport abstract class TYahkaFunctionBase implements ISubscriptionRequestor {\n    public subscriptionRequests: ISubscriptionRequest[] = [];\n    protected stateCache = new Map<string, ioBroker.IState>();\n    protected log: ILogger;\n\n    constructor(protected adapter: ioBroker.IAdapter, private logIdentifier: string = \"\") {\n        this.log = new YahkaLogger(this.adapter, this.logIdentifier);\n    }\n\n    protected addSubscriptionRequest(stateName: string) {\n        let subscriptionEvent = this.subscriptionEvent.bind(this, stateName);\n        this.subscriptionRequests.push({\n            subscriptionType: 'state',\n            subscriptionIdentifier: stateName,\n            subscriptionEvent: subscriptionEvent\n        });\n    }\n\n    protected shouldStateBeFiltered(stateName: string, ioState: ioBroker.IState): boolean {\n        return false;\n    }\n    \n    protected readValueFromIOState(ioState: ioBroker.IState): any {\n        return ioState.val;\n    }\n    protected readValueFromCache(stateName: string): ioBroker.IState {\n        if (this.stateCache.has(stateName)) {\n            return this.stateCache.get(stateName);\n        } else {\n            return undefined;\n        }\n    }\n\n    private updateCache(stateName: string, ioState: ioBroker.IState): boolean {\n        let needUpdate = false;\n        if (this.stateCache.has(stateName)) {\n            let curVal = this.stateCache.get(stateName);\n            needUpdate = curVal.val !== ioState.val;\n        } else {\n            needUpdate = true;\n        }\n\n        if (needUpdate) \n            this.stateCache.set(stateName, ioState);\n        return needUpdate;\n    }\n    subscriptionEvent(stateName: string, ioState: ioBroker.IState, callback: IInOutChangeNotify) {\n        this.log.debug('change event from ioBroker via [' + stateName + ']' + JSON.stringify(ioState));\n        if (this.shouldStateBeFiltered(stateName, ioState)) {\n            this.log.debug('state was filtered - notification is canceled');\n            return;\n        }\n\n        let cacheChange = this.updateCache(stateName, ioState);\n        if(!cacheChange) {\n            this.log.debug('state value already in cache - notification is canceled');\n            return;\n        }\n\n        this.cacheChanged(stateName, callback);\n\n    }\n\n    protected cacheChanged(stateName: string, callback: IInOutChangeNotify) {\n\n    }\n\n\n\n}\n\n","import { IInOutFunction } from './iofunc.base';\nimport { IConversionFunction } from './conversion.base';\ninterface IObjectDictionary<T> {\n    [name: string]: T;\n}\n\ntype FactoryFunction<T> = (adapter: ioBroker.IAdapter, parameters: any) => T;\n\nexport var inOutFactory: IObjectDictionary<FactoryFunction<IInOutFunction>> = {};\nexport var conversionFactory: IObjectDictionary<FactoryFunction<IConversionFunction>> = {};\n\nexport var functionFactory = {\n    createInOutFunction: function (adapter: ioBroker.IAdapter, inOutFunction: string, inOutParameters?: any): IInOutFunction {\n        if (!(inOutFunction in inOutFactory))\n            return inOutFactory[\"const\"](adapter, inOutParameters);\n        return inOutFactory[inOutFunction](adapter, inOutParameters);\n    },\n    createConversionFunction: function (adapter: ioBroker.IAdapter, conversionFunction: string, conversionParameters?: any): IConversionFunction {\n        if (!(conversionFunction in conversionFactory))\n            return conversionFactory[\"passthrough\"](adapter, conversionParameters);\n        return conversionFactory[conversionFunction](adapter, conversionParameters);\n    }\n};\n\n","import { inOutFactory, conversionFactory } from './functions.factory';\nimport { TIoBrokerInOutFunction_State, TIoBrokerInOutFunction_StateDeferred, TIoBrokerInOutFunction_State_OnlyACK } from \"./iofunc.state\";\nimport { TIoBrokerInOutFunction_Const } from './iofunc.const';\nimport { TIoBrokerInOutFunction_HomematicWindowCovering_TargetPosition } from './iofunc.homematic.covering';\nimport { TIoBrokerConversion_Passthrough } from './conversion.passthrough';\nimport { TIoBrokerConversion_HomematicControlMode_To_CoolingState, TIoBrokerConversion_HomematicDirection_To_PositionState } from './conversion.homekit.homematic';\nimport { TIoBrokerConversion_Scale } from './conversion.scale';\nimport { TIoBrokerConversion_Inverse } from './conversion.inverse';\nimport { TIoBrokerConversion_Script } from './conversion.script';\nimport { TIoBrokerInOutFunction_MultiState } from './iofunc.multi-state';\nimport { TIoBrokerConversion_Map } from './conversion.map';\n\ninOutFactory[\"ioBroker.State\"] = TIoBrokerInOutFunction_State.create;\ninOutFactory[\"ioBroker.MultiState\"] = TIoBrokerInOutFunction_MultiState.create;\ninOutFactory[\"ioBroker.State.Defered\"] = TIoBrokerInOutFunction_StateDeferred.create;\ninOutFactory[\"ioBroker.State.OnlyACK\"] = TIoBrokerInOutFunction_State_OnlyACK.create;\ninOutFactory[\"const\"] = TIoBrokerInOutFunction_Const.create;\ninOutFactory[\"ioBroker.homematic.WindowCovering.TargetPosition\"] = TIoBrokerInOutFunction_HomematicWindowCovering_TargetPosition.create;\n\nconversionFactory[\"passthrough\"] = (adapter, param) => new TIoBrokerConversion_Passthrough(adapter);\nconversionFactory[\"HomematicDirectionToHomekitPositionState\"] = (adapter, param) => new TIoBrokerConversion_HomematicDirection_To_PositionState(adapter);\nconversionFactory[\"HomematicControlModeToHomekitHeathingCoolingState\"] = (adapter, param) => new TIoBrokerConversion_HomematicControlMode_To_CoolingState(adapter);\nconversionFactory[\"level255\"] = (adapter, param) => new TIoBrokerConversion_Scale(adapter, {\n    \"homekit.min\": 0,\n    \"homekit.max\": 100,\n    \"iobroker.min\": 0,\n    \"iobroker.max\": 255\n});\nconversionFactory[\"scaleInt\"] = TIoBrokerConversion_Scale.create;\nconversionFactory[\"scaleFloat\"] = TIoBrokerConversion_Scale.create;\nconversionFactory[\"hue\"] = (adapter, param) => new TIoBrokerConversion_Scale(adapter, {\n    \"homekit.min\": 0,\n    \"homekit.max\": 360,\n    \"iobroker.min\": 0,\n    \"iobroker.max\": 65535\n});\nconversionFactory[\"inverse\"] = TIoBrokerConversion_Inverse.create;\nconversionFactory[\"script\"] = (adapter, param) => new TIoBrokerConversion_Script(adapter, param);\n// 255 -> 65535.0\n// 100 - 360\n\nconversionFactory[\"map\"] = TIoBrokerConversion_Map.create;\n","import { TYahkaFunctionBase } from './functions.base';\nimport { IInOutFunction, IInOutChangeNotify } from '../yahka.homekit-bridge';\nimport { ISubscriptionRequest, ISubscriptionRequestor } from '../yahka.ioBroker-adapter';\nexport { IInOutChangeNotify, IInOutFunction } from '../yahka.homekit-bridge';\n\nexport abstract class TIoBrokerInOutFunctionBase extends TYahkaFunctionBase implements IInOutFunction {\n    protected valueForHomeKit: any = undefined;\n    protected errorForHomeKit: any = null;\n\n    fromIOBroker(callback:(error: any, plainIOValue: any) => void) {\n        this.log.debug('fromIOBroker event - delivering cached value (' + JSON.stringify(this.valueForHomeKit) + \")\");\n        callback(null, this.valueForHomeKit);\n    }\n\n    toIOBroker(plainIoValue: any, callback: () => void) {\n        this.log.debug('writing state to ioBroker: ' + JSON.stringify(plainIoValue));\n        this.updateIOBrokerValue(plainIoValue, callback);\n    }\n\n    cacheChanged(stateName: string, callback: IInOutChangeNotify) {\n        try {\n            this.valueForHomeKit = this.recalculateHomekitValues(stateName);\n            this.errorForHomeKit = null;\n        } catch (e) {\n            this.errorForHomeKit = e;\n        }        \n        \n        if(this.valueForHomeKit)\n            callback(this.valueForHomeKit);\n    }\n\n    protected recalculateHomekitValues(stateName: string) {\n        // noop\n    }\n\n    protected updateIOBrokerValue(plainIoValue: any, callback: () => void) {\n        // to be filled in derived class\n    }\n\n}\n\nexport abstract class TIoBrokerInOutFunction_StateBase implements ISubscriptionRequestor, IInOutFunction {\n    protected debounceTimer = -1;\n    public subscriptionRequests: ISubscriptionRequest[] = [];\n\n    constructor(protected adapter: ioBroker.IAdapter, protected stateName: string, protected deferredTime: number = 0) {\n        this.addSubscriptionRequest(stateName);\n    }\n\n    addSubscriptionRequest(stateName: string) {\n        let subscriptionEvent = this.subscriptionEvent.bind(this, stateName);\n        this.subscriptionRequests.push({\n            subscriptionType: 'state',\n            subscriptionIdentifier: stateName,\n            subscriptionEvent: subscriptionEvent\n        });\n    }\n\n    getValueOnRead(ioState: ioBroker.IState): any {\n        if (ioState)\n            return ioState.val;\n        else\n            return null;\n    }\n\n    getValueOnNotify(ioState: ioBroker.IState): any {\n        if (ioState)\n            return ioState.val;\n        else\n            return null;\n    }\n\n    toIOBroker(plainIoValue, callback) {\n        this.adapter.log.debug('writing state to ioBroker [' + this.stateName + ']: ' + JSON.stringify(plainIoValue));\n        this.adapter.getForeignState(this.stateName, (error, ioState) => {\n            let value = this.getValueOnRead(ioState);\n            let valueChanged = value !== plainIoValue;\n            this.adapter.log.debug('checking value change: ' + JSON.stringify(value) + ' != ' + JSON.stringify(plainIoValue) + ' = ' + valueChanged);\n            if (valueChanged) {\n                this.adapter.setForeignState(this.stateName, plainIoValue, false, (error) => {\n                    if (error)\n                        this.adapter.log.error('setForeignState error [' + this.stateName + '] to [' + JSON.stringify(plainIoValue) + ']: ' + error);\n                    callback();\n                });\n            } else {\n                callback();\n            }\n        });\n    }\n\n    fromIOBroker(callback) {\n        this.adapter.log.debug('reading state from ioBroker [' + this.stateName + ']');\n        this.adapter.getForeignState(this.stateName, (error, ioState) => {\n            this.adapter.log.debug('read state from ioBroker [' + this.stateName + ']: ' + JSON.stringify(ioState));\n            if (error)\n                this.adapter.log.error('... with error: ' + error);\n\n            let value = this.getValueOnRead(ioState);\n            callback(error, value);\n        });\n    }\n\n    subscriptionEvent(stateName: string, ioState: ioBroker.IState, callback: IInOutChangeNotify) {\n        this.adapter.log.debug('change event from ioBroker via [' + this.stateName + ']' + JSON.stringify(ioState));\n        let newValue = this.getValueOnNotify(ioState);\n        if (newValue !== undefined)\n            this.executeCallback(callback, newValue);\n        else\n            this.adapter.log.debug('state was filtered - notification is canceled');\n    }\n\n    executeCallback(callback: IInOutChangeNotify, plainIOValue: any) {\n        if (this.deferredTime > 0)\n            this.setupDeferredChangeEvent(callback, plainIOValue);\n        else\n            callback(plainIOValue);\n    }\n\n    setupDeferredChangeEvent(callback: IInOutChangeNotify, plainIOValue: any) {\n        this.cancelDeferredChangeEvent();\n        this.debounceTimer = setTimeout(this.deferredChangeEvent.bind(this, callback, plainIOValue), 150);\n    }\n\n    cancelDeferredChangeEvent() {\n        clearTimeout(this.debounceTimer);\n        this.debounceTimer = -1;\n    }\n\n    deferredChangeEvent(callback: IInOutChangeNotify, plainIOValue: any) {\n        this.adapter.log.debug('[' + this.stateName + '] firing deferred change event:' + JSON.stringify(plainIOValue));\n        callback(plainIOValue);\n    }\n\n}","import { IInOutFunction } from \"./iofunc.base\";\nexport class TIoBrokerInOutFunction_Const implements IInOutFunction {\n\n    static create(adapter: ioBroker.IAdapter, parameters: any): IInOutFunction {\n        return new TIoBrokerInOutFunction_Const(adapter, parameters);\n    }\n\n    constructor(private adapter: ioBroker.IAdapter, private parameters: any) {\n\n    }\n\n    toIOBroker(ioValue: any, callback: () => void) {\n        callback();\n    }\n    fromIOBroker(callback: (error: any, plainIOValue: any) => void) {\n        callback(null, this.parameters);\n    }\n}\n","import { IInOutFunction, TIoBrokerInOutFunction_StateBase, IInOutChangeNotify } from \"./iofunc.base\";\n\nexport class TIoBrokerInOutFunction_HomematicWindowCovering_TargetPosition extends TIoBrokerInOutFunction_StateBase {\n    protected lastWorkingState: boolean = false;\n    protected lastAcknowledgedValue: any = undefined;\n    protected debounceTimer = -1;\n\n    static create(adapter: ioBroker.IAdapter, parameters: any): IInOutFunction {\n        let p: Array<string>;\n\n        if (typeof parameters === 'string')\n            p = [parameters];\n        else if (parameters instanceof Array)\n            p = parameters;\n        else\n            p = [];\n\n        if (p.length == 0)\n            return undefined;\n\n        let stateName: string = p[0];\n        let workingItemName: string;\n        if (p.length >= 2)\n            workingItemName = p[1];\n        else {\n            let pathNames = stateName.split('.');\n            pathNames[pathNames.length - 1] = 'WORKING';\n            workingItemName = pathNames.join('.');\n        }\n\n        return new TIoBrokerInOutFunction_HomematicWindowCovering_TargetPosition(adapter, stateName, workingItemName);\n    }\n\n\n    constructor(protected adapter: ioBroker.IAdapter, protected stateName: string, protected workingItem: string) {\n        super(adapter, stateName, 0);\n        this.addSubscriptionRequest(workingItem);\n        adapter.getForeignState(workingItem, (error, ioState) => {\n            if (ioState)\n                this.lastWorkingState = ioState.val;\n            else\n                this.lastWorkingState = undefined;\n        });\n    }\n\n    subscriptionEvent(stateName: string, ioState: ioBroker.IState, callback: IInOutChangeNotify) {\n        if (!ioState)\n            return;\n\n        if (stateName == this.workingItem) {\n            this.adapter.log.debug('[' + this.stateName + '] got a working item change event: ' + JSON.stringify(ioState));\n            this.lastWorkingState = ioState.val;\n            this.setupDeferredChangeEvent(callback);\n        } else if (stateName == this.stateName) {\n            this.adapter.log.debug('[' + this.stateName + '] got a target state change event:' + JSON.stringify(ioState));\n            if (ioState.ack) {\n                this.lastAcknowledgedValue = ioState.val;\n                this.setupDeferredChangeEvent(callback);\n            }\n        }\n    }\n\n    setupDeferredChangeEvent(callback: IInOutChangeNotify) {\n        this.cancelDeferredChangeEvent();\n        this.debounceTimer = setTimeout(this.deferredChangeEvent.bind(this, callback), 150);\n    }\n\n    cancelDeferredChangeEvent() {\n        clearTimeout(this.debounceTimer);\n        this.debounceTimer = -1;\n    }\n\n    deferredChangeEvent(callback: IInOutChangeNotify) {\n        if (!this.lastWorkingState) { // only fire callback if the covering does not move\n            this.adapter.log.debug('[' + this.stateName + '] firing target state change event:' + JSON.stringify(this.lastAcknowledgedValue));\n            callback(this.lastAcknowledgedValue);\n        } else {\n            this.adapter.log.debug('[' + this.stateName + '] canceling target state change event - covering is working');\n        }\n    }\n}\n\n","import { TIoBrokerInOutFunctionBase, IInOutFunction } from './iofunc.base';\nimport { isObject } from 'util';\n\n\nexport interface TIoBrokerInOutFunction_MultiStateParameter {\n    readState: string;\n    writeState?: string;\n    onlyAcknowledged?: boolean;\n}\n\nexport function isMultiStateParameter(value: any): value is TIoBrokerInOutFunction_MultiStateParameter {\n    if (value === undefined)\n        return false;\n    if (!isObject(value))\n        return false;\n    let propName: keyof TIoBrokerInOutFunction_MultiStateParameter = \"readState\";\n    return (propName in value);\n}\n\nexport class TIoBrokerInOutFunction_MultiState extends TIoBrokerInOutFunctionBase {\n\n    static parseParameters(parameters: any): TIoBrokerInOutFunction_MultiStateParameter[] {\n        if (Array.isArray(parameters)) {\n            return parameters.filter(isMultiStateParameter);\n        } else if (typeof parameters === \"string\") {\n            return [{ readState: parameters }];\n        } else {\n            return undefined\n        }\n    }\n    static create(adapter: ioBroker.IAdapter, parameters: any): IInOutFunction {\n        let stateNames = TIoBrokerInOutFunction_MultiState.parseParameters(parameters);\n        if (stateNames === undefined) {\n            return undefined\n        }\n        return new TIoBrokerInOutFunction_MultiState(adapter, stateNames);\n    }\n\n    constructor(protected adapter: ioBroker.IAdapter, protected stateProperties: TIoBrokerInOutFunction_MultiStateParameter[]) {\n        super(adapter, \"TIoBrokerInOutFunctionMultiState\");\n        for (let state of stateProperties) {\n            this.addSubscriptionRequest(state.readState);\n        }\n    }    \n\n    protected recalculateHomekitValues(stateName: string) {\n        let hkValues = this.stateProperties.map( (state) => this.stateCache.get(state.readState).val);\n        return hkValues.length === 1 ? hkValues[0] : hkValues;\n    }\n\n    private updateSingleIOBrokerValue(state: TIoBrokerInOutFunction_MultiStateParameter, newValue: any): Promise<void> {\n        if (newValue === undefined) \n            return Promise.resolve();\n        \n        return new Promise<void>((resolve, reject) => {\n            let stateName = state.writeState|| state.readState;\n            this.log.debug('writing state to ioBroker [' + stateName + ']: ' + JSON.stringify(newValue));\n            this.adapter.getForeignState(stateName, (error, ioState) => {\n                let value = ioState.val;\n                let valueChanged = value !== newValue;\n                this.log.debug('checking value change: ' + JSON.stringify(value) + ' != ' + JSON.stringify(newValue) + ' = ' + valueChanged);\n                if (valueChanged) {\n                    this.adapter.setForeignState(stateName, newValue, false, (error) => {\n                        if (error) {\n                            this.log.error('setForeignState error [' + stateName + '] to [' + JSON.stringify(newValue) + ']: ' + error);\n                            reject(error);\n                        }\n                        resolve();\n                    });\n                } else {\n                    resolve();\n                }\n            });\n        });\n    }\n\n    protected updateIOBrokerValue(plainIoValue: any, callback: () => void) {\n        let ioValueArray = Array.isArray(plainIoValue) ? plainIoValue : [plainIoValue];\n        let promiseArray = this.stateProperties.map( (state, index) => {\n            let newValueForThisState = ioValueArray[index];\n            return this.updateSingleIOBrokerValue(state, newValueForThisState);\n        });\n        Promise.all(promiseArray).then( () => {\n            this.log.debug('wrote all states sucessfully to ioBroker');\n            callback();\n        }).catch( (e) => {\n            this.log.error('could not write all states to ioBroker: ' + JSON.stringify(e));\n            callback();\n        });\n    }    \n}\n","import { TIoBrokerInOutFunction_StateBase, IInOutFunction } from './iofunc.base';\n\nexport class TIoBrokerInOutFunction_State extends TIoBrokerInOutFunction_StateBase {\n    static create(adapter: ioBroker.IAdapter, parameters: any): IInOutFunction {\n        if (typeof parameters !== \"string\")\n            return undefined;\n        let stateName: string = parameters;\n\n        return new TIoBrokerInOutFunction_State(adapter, stateName);\n    }\n}\n\nexport class TIoBrokerInOutFunction_StateDeferred extends TIoBrokerInOutFunction_StateBase {\n    static create(adapter: ioBroker.IAdapter, parameters: any): IInOutFunction {\n        if (typeof parameters !== \"string\")\n            return undefined;\n        let stateName: string = parameters;\n\n        return new TIoBrokerInOutFunction_StateDeferred(adapter, stateName, 250);\n    }\n}\n\nexport class TIoBrokerInOutFunction_State_OnlyACK extends TIoBrokerInOutFunction_StateBase {\n    protected lastAcknowledgedValue: any;\n\n    static create(adapter: ioBroker.IAdapter, parameters: any): IInOutFunction {\n        if (typeof parameters !== \"string\")\n            return undefined;\n        let stateName: string = parameters;\n\n        return new TIoBrokerInOutFunction_State_OnlyACK(adapter, stateName);\n    }\n\n    getValueOnRead(ioState: ioBroker.IState): any {\n        if (ioState)\n            if (ioState.ack) {\n                this.lastAcknowledgedValue = ioState.val;\n                return ioState.val;\n            } else {\n                this.adapter.log.debug(\"faking CurrentState.Read for [\" + this.stateName + ']: ' + JSON.stringify(this.lastAcknowledgedValue));\n                return this.lastAcknowledgedValue;\n            }\n        else\n            return null;\n    }\n\n    getValueOnNotify(ioState: ioBroker.IState): any {\n        if (ioState)\n            if (ioState.ack) {\n                this.lastAcknowledgedValue = ioState.val;\n                return ioState.val;\n            } else {\n                this.adapter.log.debug(\"discarding CurrentState.Notify for [\" + this.stateName + ']');\n                return undefined;\n            }\n        else\n            return null;\n    }\n}\n\n\n\n\n","/// <reference path=\"./typings/index.d.ts\" />\nimport debug = require('debug');\nimport util = require('util');\nimport HAP = require('hap-nodejs');\nimport { Configuration } from './shared/yahka.configuration';\nimport { importHAPCommunityTypesAndFixes } from './yahka.community.types';\nvar pjson = require('../package.json');\n\n// export let HAPAccessory:any = HAP.Accessory;\nexport let HAPService = HAP.Service;\nexport let HAPCharacteristic = HAP.Characteristic;\n\nimportHAPCommunityTypesAndFixes();\n\ntype IHAPService = any;\n\n// type IHAPCharacteristic = any;\n\nexport interface IConversionFunction {\n    toHomeKit(value: any): any;\n    toIOBroker(value: any): any;\n}\n\nexport interface IInOutFunction {\n    toIOBroker(ioValue: any, callback: () => void);\n    fromIOBroker(callback: (error: any, plainIOValue: any) => void);\n}\n\nexport type IInOutChangeNotify = (plainIOValue: any) => void;\n\nexport interface IHomeKitBridgeBinding {\n    conversion: IConversionFunction;\n    inOut: IInOutFunction;\n}\n\nexport interface ILogger {\n    /** log message with debug level */\n    debug(message: string);\n    /** log message with info level */\n    info(message: string);\n    /** log message with info warn */\n    warn(message: string);\n    /** log message with info error */\n    error(message: string);\n}\n\nexport interface IHomeKitBridgeBindingFactory {\n    CreateBinding(characteristicConfig: Configuration.ICharacteristicConfig, changeNotify: IInOutChangeNotify): IHomeKitBridgeBinding;\n}\n\nexport class THomeKitBridge {\n    private bridgeObject;\n\n    constructor(private config: Configuration.IBridgeConfig, private FBridgeFactory: IHomeKitBridgeBindingFactory, private FLogger: ILogger) {\n        this.init();\n    }\n\n    init() {\n        this.bridgeObject = this.setupBridge();\n        if (this.config.devices)\n            for (let device of this.config.devices) {\n                if (device.enabled === false) {\n                    continue;\n                }\n                let hapDevice = this.createDevice(device);\n                try {\n                    this.bridgeObject.addBridgedAccessory(hapDevice);\n                } catch (e) {\n                    this.FLogger.warn(e);\n                    this.FLogger.warn('Error by adding: ' + JSON.stringify(device));\n                }\n            }\n\n        this.bridgeObject.publish({\n            username: this.config.username,\n            port: this.config.port,\n            pincode: this.config.pincode,\n            category: 2,\n            mdns: {\n                interface: this.config.interface,\n                reuseAddr: true\n            }\n        });\n    }\n\n    private setupBridge() {\n        let hapBridge: HAPNodeJS.Accessory = new (<any>HAP).Bridge(this.config.name, HAP.uuid.generate(this.config.ident));\n\n        let infoService = hapBridge.getService(HAPService.AccessoryInformation);\n        infoService.setCharacteristic(HAPCharacteristic.Manufacturer, this.config.manufacturer || 'not configured');\n        infoService.setCharacteristic(HAPCharacteristic.Model, this.config.model || 'not configured');\n        infoService.setCharacteristic(HAPCharacteristic.SerialNumber, this.config.serial || 'not configured');\n        if ((this.config.firmware !== undefined) && (this.config.firmware !== \"\")) {\n            infoService.setCharacteristic(HAPCharacteristic.FirmwareRevision, this.config.firmware);\n        } else {\n            infoService.setCharacteristic(HAPCharacteristic.FirmwareRevision, pjson.version);\n        }\n\n        // Listen for bridge identification event\n        hapBridge.on('identify', (paired, callback) => {\n            this.FLogger.debug('Node Bridge identify:' + paired);\n            callback(); // success\n        });\n        return hapBridge;\n    }\n\n    private createDevice(device: Configuration.IDeviceConfig) {\n        let devName = device.name;\n        let deviceID = HAP.uuid.generate(this.config.ident + ':' + devName);\n        let i = 0;\n        while (this.bridgeObject.bridgedAccessories.some((a) => a.UUID == deviceID)) {\n            devName = device.name + '_' + ++i;\n            deviceID = HAP.uuid.generate(this.config.ident + ':' + devName);\n        }\n\n        this.FLogger.info('adding ' + devName + ' with UUID: ' + deviceID);\n        let hapDevice = new HAP.Accessory(devName, deviceID);\n\n        let infoService = hapDevice.getService(HAPService.AccessoryInformation);\n        infoService.setCharacteristic(HAPCharacteristic.Manufacturer, device.manufacturer || 'not configured');\n        infoService.setCharacteristic(HAPCharacteristic.Model, device.model || 'not configured');\n        infoService.setCharacteristic(HAPCharacteristic.SerialNumber, device.serial || 'not configured');\n        if ((device.firmware !== undefined) && (device.firmware !== \"\")) {\n            infoService.setCharacteristic(HAPCharacteristic.FirmwareRevision, device.firmware);\n        }\n\n        hapDevice.on('identify', (paired, callback) => {\n            this.FLogger.debug('device identify');\n            callback(); // success\n        });\n\n        for (let serviceConfig of device.services)\n            this.initService(hapDevice, serviceConfig);\n        return hapDevice;\n    }\n\n    private initService(hapDevice: any, serviceConfig: Configuration.IServiceConfig) {\n        if (!(serviceConfig.type in HAP.Service)) {\n            throw Error('unknown service type: ' + serviceConfig.type);\n        }\n\n        let isNew = false;\n        let hapService = hapDevice.getService(HAP.Service[serviceConfig.type]);        \n        if (hapService !== undefined) {\n            const existingSubType = hapService.subtype ? hapService.subtype : \"\"\n            if (existingSubType != serviceConfig.subType)\n                hapService = undefined;\n        }\n\n        if (hapService === undefined) {\n            hapService = new HAP.Service[serviceConfig.type](serviceConfig.name, serviceConfig.subType);\n            isNew = true;\n        }\n\n        for (let charactConfig of serviceConfig.characteristics) {\n            this.initCharacteristic(hapService, charactConfig);\n        }\n\n        if (isNew) {\n            hapDevice.addService(hapService);\n        }\n    }\n\n    private initCharacteristic(hapService: IHAPService, characteristicConfig: Configuration.ICharacteristicConfig) {\n        let hapCharacteristic = hapService.getCharacteristic(HAPCharacteristic[characteristicConfig.name]);\n        if (!hapCharacteristic) {\n            this.FLogger.warn(\"unknown characteristic: \" + characteristicConfig.name);\n            return;\n        }\n\n        if (!characteristicConfig.enabled)\n            return;\n\n        if (characteristicConfig.properties !== undefined)\n            hapCharacteristic.setProps(characteristicConfig.properties);\n\n        hapCharacteristic.binding = this.FBridgeFactory.CreateBinding(characteristicConfig, (plainIOValue: any) => {\n            this.FLogger.debug('[' + characteristicConfig.name + '] got a change notify event, ioValue: ' + JSON.stringify(plainIOValue));\n            let binding: IHomeKitBridgeBinding = hapCharacteristic.binding;\n            if (!binding) {\n                this.FLogger.error('[' + characteristicConfig.name + '] no binding!');\n                return;\n            }\n\n            let hkValue = binding.conversion.toHomeKit(plainIOValue);\n            this.FLogger.debug('[' + characteristicConfig.name + '] forwarding value from ioBroker (' + JSON.stringify(plainIOValue) + ') to homekit as (' + JSON.stringify(hkValue) + ')');\n            hapCharacteristic.setValue(hkValue, undefined, binding);\n        });\n\n        hapCharacteristic.on('set', (hkValue: any, callback: () => void, context: any) => {\n            this.FLogger.debug('[' + characteristicConfig.name + '] got a set event, hkValue: ' + JSON.stringify(hkValue));\n            let binding: IHomeKitBridgeBinding = hapCharacteristic.binding;\n            if (!binding) {\n                this.FLogger.error('[' + characteristicConfig.name + '] no binding!');\n                callback();\n                return;\n            }\n\n            if (context === binding) {\n                this.FLogger.debug('[' + characteristicConfig.name + '] set was initiated from ioBroker - exiting here');\n                callback();\n                return;\n            }\n\n            let ioValue = binding.conversion.toIOBroker(hkValue);\n            binding.inOut.toIOBroker(ioValue, () => {\n                this.FLogger.debug('[' + characteristicConfig.name + '] set was accepted by ioBroker (value: ' + JSON.stringify(ioValue) + ')');\n                callback();\n            });\n        });\n\n        hapCharacteristic.on('get', (hkCallback) => {\n            this.FLogger.debug('[' + characteristicConfig.name + '] got a get event');\n            let binding: IHomeKitBridgeBinding = hapCharacteristic.binding;\n            if (!binding) {\n                this.FLogger.error('[' + characteristicConfig.name + '] no binding!');\n                hkCallback('no binding', null);\n                return;\n            }\n\n            binding.inOut.fromIOBroker((ioBrokerError, ioValue) => {\n                let hkValue = binding.conversion.toHomeKit(ioValue);\n                // check if the value can be converetd to a number\n                if ((hkValue !== undefined) && (hkValue !== \"\")) {\n                    let numValue = Number(hkValue);\n                    if (!isNaN(numValue)) {\n                        hkValue = numValue;\n                    }\n                }\n\n                this.FLogger.debug('[' + characteristicConfig.name + '] forwarding value from ioBroker (' + JSON.stringify(ioValue) + ') to homekit as (' + JSON.stringify(hkValue) + ')');\n                hkCallback(ioBrokerError, hkValue);\n            });\n        });\n    }\n}\n\nlet hapInited: boolean = false;\nlet originalLogMethod = debug.log;\n\nexport function initHAP(storagePath: string, HAPdebugLogMethod: Function) {\n    if (hapInited) {\n        return;\n    }\n\n    HAP.init(storagePath);\n    debug.log = function () {\n        HAPdebugLogMethod(util.format.apply(this, arguments));\n    };\n}\n\nexport function deinitHAP() {\n    if (!hapInited) {\n        return;\n    }\n    debug.disable()\n    debug.log = originalLogMethod;\n    hapInited = false;\n}\n","/// <reference path=\"./typings/index.d.ts\" />\nimport { spawn } from 'child_process';\nimport { ILogger } from './yahka.homekit-bridge';\nimport util = require('util');\nimport HAP = require('hap-nodejs');\nimport { StreamController } from 'hap-nodejs/lib/StreamController';\nimport ip = require('ip');\nimport { uuid } from 'hap-nodejs';\nimport { Configuration } from './shared/yahka.configuration';\n\nlet HAPService = HAP.Service;\nlet HAPCharacteristic = HAP.Characteristic;\n\n\nexport class THomeKitIPCamera {\n    private _camera: HAPNodeJS.Accessory;\n    private streamControllers: Array<StreamController> = [];\n    private pendingSessions = {};\n    private ongoingSessions = {};\n\n\n    constructor(private camConfig: Configuration.ICameraConfig, private FLogger: ILogger) {\n        this.init();\n    }\n\n    init() {\n        if (!this.camConfig.enabled) {\n            return\n        }\n        this.createCameraDevice()\n        this.createCameraControlService();\n        this.createStreamControllers();\n        this.publishCamera();\n    }\n\n    private createOptionsDictionary() {\n        var videoResolutions = [];\n\n        var maxFPS = (this.camConfig.maxFPS > 30) ? 30 : this.camConfig.maxFPS;\n\n        if (this.camConfig.maxWidth >= 320) {\n            if (this.camConfig.maxHeight >= 240) {\n                videoResolutions.push([320, 240, maxFPS]);\n                if (maxFPS > 15) {\n                    videoResolutions.push([320, 240, 15]);\n                }\n            }\n\n            if (this.camConfig.maxHeight >= 180) {\n                videoResolutions.push([320, 180, maxFPS]);\n                if (maxFPS > 15) {\n                    videoResolutions.push([320, 180, 15]);\n                }\n            }\n        }\n\n        if (this.camConfig.maxWidth >= 480) {\n            if (this.camConfig.maxHeight >= 360) {\n                videoResolutions.push([480, 360, maxFPS]);\n            }\n\n            if (this.camConfig.maxHeight >= 270) {\n                videoResolutions.push([480, 270, maxFPS]);\n            }\n        }\n\n        if (this.camConfig.maxWidth >= 640) {\n            if (this.camConfig.maxHeight >= 480) {\n                videoResolutions.push([640, 480, maxFPS]);\n            }\n\n            if (this.camConfig.maxHeight >= 360) {\n                videoResolutions.push([640, 360, maxFPS]);\n            }\n        }\n\n        if (this.camConfig.maxWidth >= 1280) {\n            if (this.camConfig.maxHeight >= 960) {\n                videoResolutions.push([1280, 960, maxFPS]);\n            }\n\n            if (this.camConfig.maxHeight >= 720) {\n                videoResolutions.push([1280, 720, maxFPS]);\n            }\n        }\n\n        if (this.camConfig.maxWidth >= 1920) {\n            if (this.camConfig.maxHeight >= 1080) {\n                videoResolutions.push([1920, 1080, maxFPS]);\n            }\n        }\n\n        let options = {\n            proxy: false, // Requires RTP/RTCP MUX Proxy\n            srtp: true, // Supports SRTP AES_CM_128_HMAC_SHA1_80 encryption\n            video: {\n                resolutions: videoResolutions,\n                codec: {\n                    profiles: [0, 1, 2], // Enum, please refer StreamController.VideoCodecParamProfileIDTypes\n                    levels: [0, 1, 2] // Enum, please refer StreamController.VideoCodecParamLevelTypes\n                }\n            },\n            audio: {\n                codecs: [\n                    {\n                        type: \"OPUS\", // Audio Codec\n                        samplerate: 24 // 8, 16, 24 KHz\n                    },\n                    {\n                        type: \"AAC-eld\",\n                        samplerate: 16\n                    }\n                ]\n            }\n        }\n        return options\n    }\n\n    private createCameraDevice() {\n        let deviceID = HAP.uuid.generate(this.camConfig.ident + ':' + this.camConfig.name);\n        let hapDevice = new HAP.Accessory(this.camConfig.name, deviceID);\n\n        let infoService = hapDevice.getService(HAPService.AccessoryInformation);\n        infoService.setCharacteristic(HAPCharacteristic.Manufacturer, this.camConfig.manufacturer || 'not configured');\n        infoService.setCharacteristic(HAPCharacteristic.Model, this.camConfig.model || 'not configured');\n        infoService.setCharacteristic(HAPCharacteristic.SerialNumber, this.camConfig.serial || 'not configured');\n        if ((this.camConfig.firmware !== undefined) && (this.camConfig.firmware !== \"\")) {\n            infoService.setCharacteristic(HAPCharacteristic.FirmwareRevision, this.camConfig.firmware);\n        }\n\n        hapDevice.on('identify', (paired, callback) => {\n            this.FLogger.debug('camera identify');\n            callback(); // success\n        });\n        hapDevice.cameraSource = this;\n\n        this._camera = hapDevice;\n\n    }\n\n    private createCameraControlService() {\n        var controlService = new HAP.Service.CameraControl();\n        this._camera.services.push(controlService);\n    }\n\n    private createStreamControllers() {\n        let options = this.createOptionsDictionary()\n        let maxStreams = this.camConfig.numberOfStreams || 2;\n\n        for (var i = 0; i < maxStreams; i++) {\n            var streamController = new StreamController(i, options, this);\n            this._camera.services.push((<any>streamController).service);\n            this.streamControllers.push(streamController);\n        }\n    }\n\n    private publishCamera() {\n        (<any>this._camera).publish({\n            username: this.camConfig.username,\n            port: this.camConfig.port,\n            pincode: this.camConfig.pincode,\n            category: HAP.Accessory.Categories.CAMERA,\n            mdns: {\n                interface: this.camConfig.interface,\n                reuseAddr: true\n            }\n\n        }, false);\n    }\n\n    handleCloseConnection(connectionID) {\n        for (let controller of this.streamControllers) {\n            controller.handleCloseConnection(connectionID);\n        }\n    }\n\n\n    handleSnapshotRequest(request, callback) {\n        let params = {\n            source: this.camConfig.source,\n            width: request.width,\n            height: request.height,\n        }\n        let ffmpegCommand = this.camConfig.ffmpegCommandLine.snapshot.map((s) => s.replace(/\\$\\{(.*?)\\}/g, (_, word) => {\n            return params[word];\n        }));\n\n        this.FLogger.debug(\"Snapshot run: ffmpeg \" + ffmpegCommand.join(' '));\n        let ffmpeg = spawn('ffmpeg', ffmpegCommand, { env: process.env });\n\n        var imageBuffer = Buffer.alloc(0);\n\n        ffmpeg.stdout.on('data', function (data) {\n            imageBuffer = Buffer.concat([imageBuffer, (<Buffer>data)]);\n        });\n        ffmpeg.on('close', function (code) {\n            callback(undefined, imageBuffer);\n        });\n    }\n\n    prepareStream(request, callback) {\n        var sessionInfo = {};\n\n        let sessionID = request[\"sessionID\"];\n        let targetAddress = request[\"targetAddress\"];\n\n        sessionInfo[\"address\"] = targetAddress;\n\n        var response = {};\n\n        let videoInfo = request[\"video\"];\n        if (videoInfo) {\n            let targetPort = videoInfo[\"port\"];\n            let srtp_key = videoInfo[\"srtp_key\"];\n            let srtp_salt = videoInfo[\"srtp_salt\"];\n\n            let videoResp = {\n                port: targetPort,\n                ssrc: 1,\n                srtp_key: srtp_key,\n                srtp_salt: srtp_salt\n            };\n\n            response[\"video\"] = videoResp;\n\n            sessionInfo[\"video_port\"] = targetPort;\n            sessionInfo[\"video_srtp\"] = Buffer.concat([srtp_key, srtp_salt]);\n            sessionInfo[\"video_ssrc\"] = 1;\n        }\n\n        let audioInfo = request[\"audio\"];\n        if (audioInfo) {\n            let targetPort = audioInfo[\"port\"];\n            let srtp_key = audioInfo[\"srtp_key\"];\n            let srtp_salt = audioInfo[\"srtp_salt\"];\n\n            let audioResp = {\n                port: targetPort,\n                ssrc: 1,\n                srtp_key: srtp_key,\n                srtp_salt: srtp_salt\n            };\n\n            response[\"audio\"] = audioResp;\n\n            sessionInfo[\"audio_port\"] = targetPort;\n            sessionInfo[\"audio_srtp\"] = Buffer.concat([srtp_key, srtp_salt]);\n            sessionInfo[\"audio_ssrc\"] = 1;\n        }\n\n\n        let currentAddress = ip.address();\n        var addressResp = {\n            address: currentAddress\n        };\n\n        if (ip.isV4Format(currentAddress)) {\n            addressResp[\"type\"] = \"v4\";\n        } else {\n            addressResp[\"type\"] = \"v6\";\n        }\n\n        response[\"address\"] = addressResp;\n        this.pendingSessions[uuid.unparse(sessionID, 0)] = sessionInfo;\n\n        callback(response);\n    }\n\n    handleStreamRequest(request) {\n        var sessionID = request[\"sessionID\"];\n        var requestType = request[\"type\"];\n        if (sessionID) {\n            let sessionIdentifier = uuid.unparse(sessionID, 0);\n\n            if (requestType == \"start\") {\n                var sessionInfo = this.pendingSessions[sessionIdentifier];\n                if (sessionInfo) {\n                    var width = 1280;\n                    var height = 720;\n                    var fps = 30;\n                    var bitrate = 300;\n                    var codec = this.camConfig.codec || 'libx264';\n\n                    let videoInfo = request[\"video\"];\n                    if (videoInfo) {\n                        width = videoInfo[\"width\"];\n                        height = videoInfo[\"height\"];\n\n                        let expectedFPS = videoInfo[\"fps\"];\n                        if (expectedFPS < fps) {\n                            fps = expectedFPS;\n                        }\n\n                        bitrate = videoInfo[\"max_bit_rate\"];\n                    }\n\n                    let targetAddress = sessionInfo[\"address\"];\n                    let targetVideoPort = sessionInfo[\"video_port\"];\n                    let videoKey = sessionInfo[\"video_srtp\"];\n\n\n                    let params = {\n                        source: this.camConfig.source,\n                        codec: codec,\n                        fps: fps,\n                        width: width,\n                        height: height,\n                        bitrate: bitrate,\n                        videokey: videoKey.toString('base64'),\n                        targetAddress: targetAddress,\n                        targetVideoPort: targetVideoPort\n                    }\n                    let ffmpegCommand = this.camConfig.ffmpegCommandLine.stream.map((s) => s.replace(/\\$\\{(.*?)\\}/g, (_, word) => {\n                        return params[word];\n                    }));\n\n                    this.FLogger.debug(\"Stream run: ffmpeg \" + ffmpegCommand.join(' '));\n                    let ffmpeg = spawn('ffmpeg', ffmpegCommand, { env: process.env });\n                    var devnull = require('dev-null');\n                    ffmpeg.stdout.pipe(devnull());\n                    ffmpeg.stderr.pipe(devnull());\n                    this.ongoingSessions[sessionIdentifier] = ffmpeg;\n                }\n\n                delete this.pendingSessions[sessionIdentifier];\n            } else if (requestType == \"stop\") {\n                var ffmpegProcess = this.ongoingSessions[sessionIdentifier];\n                if (ffmpegProcess) {\n                    ffmpegProcess.kill('SIGKILL');\n                }\n\n                delete this.ongoingSessions[sessionIdentifier];\n            }\n        }\n    }\n}","import { THomeKitIPCamera } from './yahka.homekit-ipcamera';\nimport { Configuration } from './shared/yahka.configuration';\nimport {IInOutFunction} from './yahka.homekit-bridge';\n/// <reference path=\"./typings/index.d.ts\" />\nimport * as hkBridge from './yahka.homekit-bridge';\n// import * as mac from './node_modules/macaddress';\nimport {functionFactory} from './yahka.functions/functions.factory';\n\n\nexport type TSubscriptionType = 'state' | 'object';\n\nexport interface ISubscriptionRequest {\n    subscriptionType: TSubscriptionType;\n    subscriptionIdentifier: string;\n    subscriptionEvent: (ioValue: any, callback: hkBridge.IInOutChangeNotify) => void;\n}\nexport interface ISubscriptionRequestor {\n    subscriptionRequests: ISubscriptionRequest[];\n}\n\nfunction isSubscriptionRequestor(param: Object): param is ISubscriptionRequestor {\n    return param[\"subscriptionRequests\"] !== undefined &&\n        param[\"subscriptionRequests\"] instanceof Array;\n}\ninterface ICustomCharacteristicConfig extends Configuration.ICharacteristicConfig {\n    conversionFunction?:string;\n    conversionParameters?:any;\n    inOutFunction?:string;\n    inOutParameters?:any;\n}\n\nfunction isCustomCharacteristicConfig(config:Configuration.ICharacteristicConfig):config is ICustomCharacteristicConfig {\n    if (!config)\n        return false;\n    let myConfig = <ICustomCharacteristicConfig>config;\n    return (myConfig.inOutFunction !== undefined) || (myConfig.conversionFunction !== undefined) || (myConfig.inOutParameters !== undefined);\n}\n\nexport class TIOBrokerAdapter implements hkBridge.IHomeKitBridgeBindingFactory {\n    stateToEventMap:Map<string, hkBridge.IInOutChangeNotify[]> = new Map<string, hkBridge.IInOutChangeNotify[]>();\n    objectToEventMap:Map<string, hkBridge.IInOutChangeNotify[]> = new Map<string, hkBridge.IInOutChangeNotify[]>();\n    devices: Array<Object> = [];\n    verboseHAPLogging:boolean = false;\n\n    constructor(private adapter:ioBroker.IAdapter, private controllerPath) {\n        adapter.on('ready', this.adapterReady.bind(this));\n        adapter.on('stateChange', this.handleState.bind(this));\n        adapter.on('message', this.handleMessage.bind(this));\n        adapter.on('unload', this.handleUnload.bind(this));\n    }\n\n    private adapterReady() {\n        hkBridge.initHAP(this.controllerPath + '/' + this.adapter.systemConfig.dataDir + this.adapter.name + '.' + this.adapter.instance + '.hapdata', this.handleHAPLogEvent.bind(this));\n\n        this.adapter.log.info('adapter ready, checking config');\n        let config = this.adapter.config;\n        this.createHomeKitBridges(config);\n        this.createCameraDevices(config);\n    }\n\n    private createHomeKitBridges(config: any) {\n        let bridgeConfig:Configuration.IBridgeConfig = config.bridge;\n        if (!config.firstTimeInitialized) {\n            this.adapter.log.info('first time initialization');\n            this.adapter.log.debug('system config:' + JSON.stringify(this.adapter.systemConfig));\n\n            bridgeConfig.ident = \"Yahka-\" + this.adapter.instance;\n            bridgeConfig.name = bridgeConfig.ident;\n            bridgeConfig.serial = bridgeConfig.ident;\n            let usr = [];\n            for (let i = 0; i < 6; i++)\n                usr[i] = ('00' + (Math.floor((Math.random() * 256)).toString(16))).substr(-2);\n            bridgeConfig.username = usr.join(':');\n            bridgeConfig.pincode = '123-45-678';\n            bridgeConfig.port = 0;\n            bridgeConfig.verboseLogging = false;\n            config.firstTimeInitialized = true;\n            this.adapter.extendForeignObject('system.adapter.' + this.adapter.name + '.' + this.adapter.instance, {native: config}, undefined);\n        }\n        this.verboseHAPLogging = bridgeConfig.verboseLogging == true;\n\n        this.adapter.log.debug('creating bridge');\n        this.devices.push(new hkBridge.THomeKitBridge(config.bridge, this, this.adapter.log));        \n    }\n\n    private createCameraDevices(config: any) {\n        let cameraArray:Array<Configuration.ICameraConfig> = config.cameras;\n        if (cameraArray === undefined)\n            return;\n        \n        for (let cameraConfig of cameraArray) {\n            this.adapter.log.debug('creating camera');\n            this.devices.push(new THomeKitIPCamera(cameraConfig, this.adapter.log));\n        }\n    }\n\n    private handleHAPLogEvent(message) {\n        if (this.verboseHAPLogging) {\n            console.log(\"HAP debug message\", message);\n            this.adapter.log.debug(\"HAP debug message: \" + message);\n        }\n    }\n\n    private handleState(id:string, state:ioBroker.IState) {\n        // Warning, state can be null if it was deleted\n        let notifyArray = this.stateToEventMap.get(id);\n        if (!notifyArray) {\n            //this.adapter.log.debug('nobody subscribed for this state');\n            return;\n        }\n        this.adapter.log.debug('got a stateChange for [' + id + ']');\n\n        // try to convert it to a number\n        convertStateValueToNumber(state);        \n\n        for (let method of notifyArray)\n            method(state);\n    }\n\n    private handleMessage(obj:any) {\n        if (typeof obj === 'object' && obj.message) {\n            if (obj.command === 'send') {\n                // Send response in callback if required\n                if (obj.callback)\n                    this.adapter.sendTo(obj.from, obj.command, 'Message received', obj.callback);\n            }\n        }\n    }\n\n    private handleUnload(callback) {\n        try {\n            this.adapter.log.info('cleaning up ...');\n            hkBridge.deinitHAP();\n            this.adapter.log.info('cleaned up ...');\n            callback();\n        } catch (e) {\n            callback();\n        }\n    }\n\n    private handleInOutSubscriptionRequest(requestor:ISubscriptionRequestor, changeNotify:hkBridge.IInOutChangeNotify) {\n        if (requestor.subscriptionRequests.length == 0)\n            return;\n\n        for (let subscriptionRequest of requestor.subscriptionRequests) {\n            let changeInterceptor = (ioValue:any) => subscriptionRequest.subscriptionEvent(ioValue, changeNotify);\n\n\n            if (subscriptionRequest.subscriptionType === 'state') {\n                let existingArray = this.stateToEventMap.get(subscriptionRequest.subscriptionIdentifier);\n                if (!existingArray) {\n                    existingArray = [changeInterceptor];\n                    this.stateToEventMap.set(subscriptionRequest.subscriptionIdentifier, existingArray);\n                } else\n                    existingArray.push(changeInterceptor);\n\n                this.adapter.subscribeForeignStates(subscriptionRequest.subscriptionIdentifier);\n                this.adapter.log.debug('added subscription for: [' + subscriptionRequest.subscriptionType + ']' + subscriptionRequest.subscriptionIdentifier);\n                this.adapter.getForeignState(subscriptionRequest.subscriptionIdentifier, (_, value) => {\n                    convertStateValueToNumber(value);\n                    changeInterceptor(value)\n                });\n            } else {\n                this.adapter.log.warn('unknown subscription type: ' + subscriptionRequest.subscriptionType);\n            }\n        }\n\n    }\n\n    public CreateBinding(characteristicConfig:Configuration.ICharacteristicConfig, changeNotify:hkBridge.IInOutChangeNotify):hkBridge.IHomeKitBridgeBinding {\n        if (isCustomCharacteristicConfig(characteristicConfig)) {\n            let inoutFunc = functionFactory.createInOutFunction(this.adapter, characteristicConfig.inOutFunction, characteristicConfig.inOutParameters);\n            if (inoutFunc === undefined) {\n                this.adapter.log.error('[' + characteristicConfig.name + '] could not create inout-function: ' + characteristicConfig.inOutFunction + ' with params: ' + JSON.stringify(characteristicConfig.inOutParameters));\n                return undefined;\n            }\n\n            let convFunc = functionFactory.createConversionFunction(this.adapter, characteristicConfig.conversionFunction, characteristicConfig.conversionParameters);\n            if (convFunc === undefined) {\n                this.adapter.log.error('[' + characteristicConfig.name + '] could not create conversion-function: ' + characteristicConfig.conversionFunction + ' with params: ' + JSON.stringify(characteristicConfig.conversionParameters));\n                return undefined;\n            }\n            \n            if(isSubscriptionRequestor(inoutFunc)) {\n                this.handleInOutSubscriptionRequest(inoutFunc, changeNotify);\n            }\n            \n            return {\n                conversion: convFunc,\n                inOut: inoutFunc\n            }\n        }\n        return null;\n    }\n}\n\nfunction convertStateValueToNumber(state: ioBroker.IState) {\n    if ((state) && (state.val !== \"\") && (state.val != null)) {\n        let numValue = Number(state.val);\n        if (!isNaN(numValue)) {\n            state.val = numValue;\n        }\n    }\n}\n","module.exports = require(\"child_process\");","module.exports = require(\"debug\");","module.exports = require(\"dev-null\");","module.exports = require(\"hap-nodejs\");","module.exports = require(\"hap-nodejs-community-types\");","module.exports = require(\"hap-nodejs/lib/Characteristic\");","module.exports = require(\"hap-nodejs/lib/Service\");","module.exports = require(\"hap-nodejs/lib/StreamController\");","module.exports = require(\"hap-nodejs/lib/gen/HomeKitTypes\");","module.exports = require(\"ip\");","module.exports = require(\"util\");"],"sourceRoot":""}